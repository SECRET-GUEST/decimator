#          ████████     ██████
#         █░░░░░░░░██_██░░░░░░█
#        █░░░░░░░░░░░█░░░░░░░░░█
#       █░░░░░░░███░░░█░░░░░░░░░█
#       █░░░░███░░░███░█░░░████░█
#     █░░░██░░░░░░░░███░██░░░░██
#    █░░░░░░░░░░░░░░░░░█░░░░░░░░███
#    █░░░░░░░░░░░░░██████░░░░░████░░█
#    █░░░░░░░░░█████░░░████░░██░░██░░█
#   ██░░░░░░░███░░░░░░░░░░█░░░░░░░░███
#  █░░░░░░░░░░░░░░█████████░░█████████
# █░░░░░░░░░░█████ ████   ████ █████ █
# █░░░░░░░░░░█      █ ███   █   ███ █ █
#█░░░░░░░░░░░░█   ████ ████    ██ ████
#░░░░░░░░░░░░░█████████░░░████████░░░█
#░░░░░░░░░░░░░░░░█░░░░░█░░░░░░░░░░░░█
#░░░░░░░░░░░░░░░░░░░░██░░░░█░░░░░░██
#░░░░░░░░░░░░░░░░░░██░░░░░░░███████
#░░░░░░░░░░░░░░░░██░░░░░░░░░░█░░░░░█                                            _____                                 _____                                            _____                                                   _____
#░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░█                                          /\    \                               /\    \                                          /\    \                                                 /\    \
#░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░█                      ::                 /::\    \                             /::\    \                                        /::\____\                                               /::\____\
#░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░█                                        /::::\    \                           /::::\    \           :::         ::           ::: ::/    /                         :                   :: ::/    /
#░░░░░░░░░░░█████████░░░░░░░░░░░░░░██                                       /::::::\    \                         /::::::\    \                               ::: : :::/    /                                              /:::/    /
#░░░░░░░░░░█▒▒▒▒▒▒▒▒███████████████▒▒█                                     /:::/\:::\    \                    :: ::::/\:::\    \                                  /:::/    /                                              /:::/    /
#░░░░░░░░░█▒▒███████▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒█                                    /:::/__\:::\    \                     /:::/__\:::\    \                                /:::/    /                                            :::: :/____/
#░░░░░░░░░█▒▒▒█▓▓▓▓██████████████████                                    /::::\   \:::\    \                   /::::\   \:::\    \                              /:::/    /                                              /::::\    \
#░░░░░░░░░██▒▒█▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█                                       /::::::\   \:::\    \                 /::::::\   \:::\    \                            /:       /      _____                                   /::::::\    \   _____
#░░░░░░░░░░█▒▒█▓█████████████████ ████                                 /:::/\:::\   \:::\ ___\               /:::/\:::\   \:::\____\                          /:::/____/      /\    \                                 /:::/\:::\    \ /\    \
#░░░░░░░░░░█▒▒██▓▓▒▓▒▓▒▓▒▒▒▒▒▒▒▒▓█▓▒▒▒█                               /:::/__\:::\   \:::|    |             /:::/  \:::\   \:::|    |                         :::|    /      /::\____\                        ::::::: :::/ : :::\    /::\____\
#░░░░░░░░░█▒▒████████▓▒███▓██▒▒▒▒▒▒▒▒▒█                  :            \:::\   \:::\  /:::|____|             \::/   |::::\  /:::|____|                      : :: :|____\     /:::/    /                               \::/    \:::\: ::::/    /
#░░░░░░░░░█▒▒▒▒▒▒▒▒▒█████████████▓█▓██                                 \:::\   \:::\/:::/    /               \/____|:::::\/:::/    /                          \:::\    \   /:::/    /                                 \/____/: :::\/:::/    /
#░░░░░░░░░░████████▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒█                                  \:::\   \::::::/    /                      |:::::::::/    /                            \:::\   :: : ::/    /                                 :  :  : : :::::::/    /
#░░░░░░░░░░░░░░░░░░██████████████████                                    \:::\   \::::/    /          :  :         |::|\::::/    /           ::                 \:::\    /:::/    /               ::::                          \::       /
#░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░█            ::                           \:::\  /:::/    /                      :: ::| \::/____/                                \:::\__/:::/    /                                              /:::/    /
#██░░░░░░░░░░░░░░░░░░░░░░░░░░░██                                           \:::\/:::/    /                         |::|  ~|                                       \::::::::/    /                                             : :::/    /
#▓██░░░░░░░░░░░░░░░░░░░░░░░░██                                              \::::::/    /                          |::|   |                                        \::::::/    /                                              /:::/    /
#▓▓▓███░░░░░░░░░░░░░░░░░░░░█                                                 \::::/    /                           \::|   |                                         \::::/    /                              ::: :           /:::/    /
#▓▓▓▓▓▓███░░░░░░░░░░░░░░░██                                 :                 \::/____/            :                \:|   |               :    ::::                  \::/____/                                               \::/    /
#▓▓▓▓▓▓▓▓▓███████████████▓▓█                                                   ⠋                                     \|___|                                           ⠩                                                      \/____/
#▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓██
#▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█                                                                                                                                                                                                                                               |                                                                    |                                      |
#▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█                                                                    |                                                                                                             |
#______________________________                                                                                                                       |                                                                                                                      |                                                                                                                                              |                    |
#___________________________
#_ ______ _____ _________
# /            /                                                         |                                |                       |                    |                |                       |                    |                |                       |                    |                     |                       |                    |
                
#        \                          |                                |                                               |  |                                          |                    |                                          |                       |                    |  |                                           |                    |        |                    |                              |
                

#      |               |                                 |
                
#                  |                                                |            |                                   |                               |                           |                               |                           |                               |                                |                               |
#           |                                  |                                     |
                
#                  |                     |                                                     |                                   |                               |     |                                   |                               |     |                                   |                               |          |                                   |                               |
#   |                          |                       |                    |
#           |                                    |                                         |     |                    |                                    | |     |                    |                                    | |     |                    |                                    |      |     |                                                        |
#      |                        |                                 |      |                                |                       |                    |                |                       |                    |                |                       |                    |                     |                       |                    |
                
#                      |                                                |      |                                   |                               |                         |                               |                         |                               |                              |                               |
#           |                                   |                               |                   |                                |                       |                    |          |                                |                       |                    |          |                                |                       |                    |               |                                |                                        |
                
#                  |                     |
#   |                                |                       |                    |            |                                |                       |                    |     |                                |                       |                    |     |                                |                       |                              |                                |
#           |                               |                                         |                              |                       |                    |                           |                       |                    |                           |                       |                    |                                |                       |                    |
                
#   |         |                                   PRESENTATION                                                |                                |                    |   |                                |                    |   |                                |                    |        |                                |                    |
#                                                                                                                               |                               |     |                                   |                               |     |                                   |                               |          |                                   |                               |
#                |                             /                 \                          |                                                                              |                               |     |                                   |                               |     |                                   |                               |          |                                   |                               |
                
#        |                             This tool will help you to remove
                
#                               obsolete or unwanted things from your computer .                     |                                           |               |                                           |               |                                           |                    |                                           |
                
#                           /                      |    v    |                    \
                
#                   It removes all files named by the selected name present in the folder and              |                                |                                          |      |                                |                                          |      |                                |                                          |           |                                |
#                                                                                                    |                                                                 |                      |                     |                       |                      |                     |                       |                      |                     |                            |
#              subfolders of the selected folder without throwing it in the trash, so do it carefully
#      |                  !      |                                   |     |                                |                       |                    |                |                       |                    |                |                       |                    |                    |                                           |
#                                |                                   |     |                  
#                   |            |                   Anyway          !                        |                                         |                                |                       |                    |                |                       |                    |                |                       |                    |                    |
                
#              |                      |                 have                                                 |                        |                                         |                                |                       |                    |                |                       |                    |                |                       |                    |                     |                                           |
                

#                 |                                  FUN         |                        |                                         |                                |                       |                    |                |                       |                    |                |                       |                    |                    |                                                                      |
                
#                                                         =)
                
#
#                                |                      or                                       |                                                            |                    |                |                       |                    |                |                       |                    |                    |                                           |
                

#              |                              |       DIE ! ! !        |                       |                            |                |                       |                    |                |                       |                    |                    |                                           |#      |                        |                                         |                                |
                
#
#                                                     !                                       |                                |                    |  |                                |                    |  |                                |                    |       |                                |                    |
                
#      |               |                                 !
                
#                  |                                                |            |                                   |                               |                           |                               |                           |                               |                                |                               |
#           |                                  !                                     |
                
#                  |                     |                                                     |                                   |                               |     |                                   |                               |     |                                   |                               |          |                                   |                               |
#   |                          |                       |                    !
#           |                                    |                                         |     |                    |                                    | |     |                    |                                    | |     |                    |                                    |      |     |                    |                                    |
#      |                        |                                 |      |                                |                       |                    |                |                       |                    |                |                       |                    |                    |                                           |
                
#                      |                                                |      |                                   |                               |                         |                               |                         |                               |                              |                               |
#           |                                   |                               |                   |                                |                       |                    |          |                                |                       |                    |          |                                |                       |                    |               |                                                                |
                
#                  |                     |
#   |                                |                       |                    |            |                                |                       |                    |     |                                |                       |                    |                                    |                       |                              |                                                                        |
#           |                               |                                         !                              |                       |                    |                           |                       |                    |                           |                       |                    |                                |                       |                    |
                
#_ _  _ ____ ___ ____ _    _    ____ ___ _ ____ _  _
#| |\ | [__   |  |__| |    |    |__|  |  | |  | |\ |
#| | \| ___]  |  |  | |___ |___ |  |  |  | |__| | \|
                

import os,sys,shutil
from PyQt5.QtGui import QIcon
from PyQt5.QtWidgets import (QApplication, QWidget, QPushButton, QLineEdit, QLabel, QFileDialog, QVBoxLayout, QMessageBox, QCheckBox,
                             QProgressBar, QDialog, QDialogButtonBox)


#___  ____ _ _ _ ____ ____    ___  _    ____ _  _ ___
#|__] |  | | | | |___ |__/    |__] |    |__| |\ |  |
#|    |__| |_|_| |___ |  \    |    |___ |  | | \|  |
                

#OPENING | https://www.youtube.com/watch?v=_85LaeTCtV8 :3
                


#function to make an exe file with py to exe
def ressource_path(relative_path):
    try:
        base_path=sys._MEIPASS
    except Exception:
        base_path = os.path.abspath('.')
    return os.path.join(base_path ,relative_path)
#to make it works, you have to rename all your path with ressource_path (/path/) WHEN YOU WILL TURN THE SCRIPT TO EXE
#Example : /icon/lol.png  BECOME  ressource_path(/icon/lol.png)



class decimator(QWidget):
    def __init__(self):
        super().__init__()
        self.GUI()



#___  ____ ____ ____ ____ ____ _  _ 
#|__] |__/ |  | | __ |__/ |__| |\/| 
#|    |  \ |__| |__] |  \ |  | |  | 
#                                   


#function to select folder
    def select_folder(self):
        folder_path = QFileDialog.getExistingDirectory(self, "Select a folder")
        self.lab_selecter.setText(f"Selected folder: {folder_path}")



#Function to delete files
    def delete_files(self):
        
        self.select_folder()

        #Get folder path and target file/folder name from the UI
        folder_path = self.lab_selecter.text().split(": ")[1]
        target_name = self.entry_name.text().strip()

        #Check if the specified folder exists
        if not os.path.exists(folder_path):
            # Display a warning message if the folder does not exist
            QMessageBox.warning(self, "Folder not found", "The specified folder was not found.")
            return


        #button of your confirmation pop up
        dial_confirm = QDialog(self)
        dial_confirm.setWindowTitle("Confirmation")

        lay_confirm = QVBoxLayout(dial_confirm)
        lay_confirm.addWidget(QLabel(f"Are you sure you want to delete all files and folders with the name '{target_name}'?"))

        btn_popup = QDialogButtonBox(QDialogButtonBox.Yes | QDialogButtonBox.No, dial_confirm)
        btn_popup.accepted.connect(dial_confirm.accept)
        btn_popup.rejected.connect(dial_confirm.reject)
        lay_confirm.addWidget(btn_popup)

        result = dial_confirm.exec_()

        
        if result == QDialog.Accepted:

            #Progress dialog
            dial_progress = QDialog(self)
            dial_progress.setWindowTitle("Deleting...")

            bar_progress = QProgressBar(dial_progress)
            bar_progress.setValue(0)

            lay_progress = QVBoxLayout(dial_progress)
            lay_progress.addWidget(bar_progress)

            dial_progress.show()


            #Refresh the user interface
            QApplication.processEvents()


            #Check if file names are case-sensitive
            case_sensitive = self.s_case.isChecked()


            #Initialize counters
            del_items_count = 0
            total_items_count = sum([len(files) + len(dirs) for _, dirs, files in os.walk(folder_path)])


            #Delete all files and folders with the target name
            for root, dirs, files in os.walk(folder_path):
                for file in files:

                    #Check if the file name matches the target name
                    if (file == target_name) if case_sensitive else (file.lower() == target_name.lower()):
                        file_path = os.path.join(root, file)

                        try:
                            #Check if the file is open and can be deleted
                            with open(file_path) as file:
                                pass

                            os.remove(file_path) #so delete

                        except PermissionError:
                            QMessageBox.warning(self, "Deletion not possible", f"Cannot delete the file '{file_path}' because it is in use.")

                        except Exception as e:
                            QMessageBox.warning(self, "Deletion error", f"An error occurred while deleting the file '{file_path}': {e}")



                    #Update progress bar
                    del_items_count += 1
                    bar_progress.setValue(int((del_items_count / total_items_count) * 100))
                    QApplication.processEvents()


                for dir in dirs:
                    #Check if the folder name matches the target name
                    if (dir == target_name) if case_sensitive else (dir.lower() == target_name.lower()):
                        dir_path = os.path.join(root, dir)

                        try:
                            # Delete the folder and its contents
                            shutil.rmtree(dir_path)

                        except PermissionError:
                            QMessageBox.warning(self, "Deletion not possible", "Cannot delete the folder because it is in use.")

                        except Exception as e:
                            QMessageBox.warning(self, "Deletion error", f"An error occurred while deleting the folder: {e}")


                    #Update again
                    del_items_count += 1
                    bar_progress.setValue(int((del_items_count / total_items_count) * 100))
                    QApplication.processEvents()


            #Close progress dialog
            dial_progress.accept()


            QMessageBox.information(self, "Deletion completed", "The script has finished executing.")


    def GUI(self):
        
        #Title and Icon
        self.setWindowTitle("D E C I M A T O R")
        self.setWindowIcon(QIcon(ressource_path("assets/ico/decimator.png")))

        #Style of the whole application (css)
        self.setStyleSheet("""

            QWidget {
                background-color: #B0F2B4;
                color: #023047;
                font-family: "Comic Sans MS";
            }

            

            QMessageBox{
                background-color: #B0F2B4;
                color: #023047;
                font-family: "Comic Sans MS";
            }





            QLineEdit {
                border: 2px solid #023047;
                border-radius: 10px;
                padding: 5px;
                background-color: #fff;
                color: #023047;
                font-family: "Comic Sans MS";
            }
            
            QLineEdit:focus {
                border-color: #F2E2BA;
            }

            


            QCheckBox::indicator {
                border: 0.5px solid #023047;
                border-radius: 50%; 
                width: 10px;
                height: 10px;
            }

            QCheckBox::indicator:checked {
                background-color: #023047;
                border-color: #023047;
            }

            QCheckBox::indicator:hover {
                border-color: #F2E2BA;
            }

            QCheckBox::indicator:checked:hover {
                background-color: #F2E2BA;
                border-color: #F2E2BA;
            }

            QCheckBox::indicator:disabled {
                border-color: #B0F2B4;
                background-color: #B0F2B4;
            }


            

            QPushButton {
                background-color: #F2E2BA;
                color: #023047;
                border-top-right-radius: 10px;
                border-bottom-left-radius: 10px;
                padding: 5px 10px;
            }
            
            QPushButton:hover {
                background-color: #c7baf2;
            }
            
            QPushButton:pressed {
                background-color: #A0E2A4;
            }
            
                       

            QMessageBox QHeaderView::section, QMainWindow QHeaderView::section, QDockWidget QHeaderView::section {
                background-color: #B0F2B4;
                color: #023047;
            }
            

            """)
        
        #Widgets

        self.entry_name = QLineEdit(self)
        self.entry_name.setPlaceholderText("Enter the NAME of something ")

        self.btn_delete = QPushButton("Delete files", self)
        self.btn_delete.clicked.connect(self.delete_files)

        self.s_case = QCheckBox("Consider case sensitivity", self)

        #Add widgets to a layout
        lay_decimator = QVBoxLayout(self)
        lay_decimator.addWidget(self.entry_name)
        lay_decimator.addWidget(self.s_case)
        lay_decimator.addWidget(self.btn_delete)

        



#____ ____ ____ _  _ ____ ___    _    ____ _  _ _  _ ____ _  _
#|__/ |  | |    |_/  |___  |     |    |__| |  | |\ | |    |__|
#|  \ |__| |___ | \_ |___  |     |___ |  | |__| | \| |___ |  |
                
#ENDING | https://www.youtube.com/watch?v=CgZVrvQZB6U&ab_channel=SECRETGUEST :3


if __name__ == "__main__":
    app = QApplication([])
    Decimator = decimator()
    Decimator.show()
    app.exec_()
